@baseUrl = http://127.0.0.1:8000
@apiBase = {{baseUrl}}/api/v1
@dbName = demo
@pgUrl = postgres://postgres:postgres@localhost:5432/postgres
@mysqlDbName = interview_db
@mysqlUrl = mysql://root:leacock@localhost:3306/interview_db

###
# Health check (implemented)
GET {{baseUrl}}/health
Accept: application/json

###
# List connections
GET {{apiBase}}/dbs
Accept: application/json

###
# Create or update connection
PUT {{apiBase}}/dbs/{{dbName}}
Content-Type: application/json
Accept: application/json

{
  "url": "{{pgUrl}}"
}

###
# Get one connection with metadata
GET {{apiBase}}/dbs/{{dbName}}
Accept: application/json

###
# =========================
# MySQL support test cases
# =========================

###
# Create or update MySQL connection
PUT {{apiBase}}/dbs/{{mysqlDbName}}
Content-Type: application/json
Accept: application/json

{
  "url": "{{mysqlUrl}}"
}

###
# Get MySQL connection with metadata
GET {{apiBase}}/dbs/{{mysqlDbName}}
Accept: application/json

###
# Refresh MySQL metadata
POST {{apiBase}}/dbs/{{mysqlDbName}}/refresh
Accept: application/json

###
# Execute MySQL SQL query
POST {{apiBase}}/dbs/{{mysqlDbName}}/query
Content-Type: application/json
Accept: application/json

{
  "sql": "SELECT table_name FROM information_schema.tables WHERE table_schema = 'interview_db' LIMIT 10"
}

###
# Natural language to MySQL SQL
POST {{apiBase}}/dbs/{{mysqlDbName}}/query/natural
Content-Type: application/json
Accept: application/json

{
  "prompt": "list first 10 table names from interview_db"
}

###
# Delete MySQL connection
DELETE {{apiBase}}/dbs/{{mysqlDbName}}
Accept: application/json

###
# Refresh metadata
POST {{apiBase}}/dbs/{{dbName}}/refresh
Accept: application/json

###
# Execute SQL query
POST {{apiBase}}/dbs/{{dbName}}/query
Content-Type: application/json
Accept: application/json

{
  "sql": "SELECT 1 AS value"
}

###
# Generate SQL from natural language
POST {{apiBase}}/dbs/{{dbName}}/query/natural
Content-Type: application/json
Accept: application/json

{
  "prompt": "List the latest 10 rows from users table"
}

###
# Delete connection
DELETE {{apiBase}}/dbs/{{dbName}}
Accept: application/json

###
# Verify deletion
GET {{apiBase}}/dbs/{{dbName}}
Accept: application/json
